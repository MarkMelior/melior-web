---
note: 'Auth'
title: 'Next.js: Authentication'
description: 'Best practices for Server Components, Actions, Middleware'
tags: ['TypeScript', 'Cookie', 'SSR', 'Prisma']
---

<AuthExample />

## About this approach

Getting user data: `const user = await getUser();`. It's very simple :)

- hi
- man `test` good!
- i'm good

test))

```TypeScript filename="src/features/auth/api/jwt.ts"
import { SignJWT, jwtVerify } from 'jose';
import { SessionPayload } from '../types/definitions';

const secretKey = process.env.SESSION_SECRET;
const encodedKey = new TextEncoder().encode(secretKey);

export async function encrypt(payload: SessionPayload) {
	return new SignJWT(payload)
		.setProtectedHeader({ alg: 'HS256' })
		.setIssuedAt()
		.setExpirationTime('7d')
		.sign(encodedKey);
}

export async function decrypt(session: string | undefined = '') {
	try {
		const { payload } = await jwtVerify(session, encodedKey, {
			algorithms: ['HS256'],
		});
		return payload;
	} catch (error) {
		// console.log('Failed to verify session');
		return null;
	}
}
```
