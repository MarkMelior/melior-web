---
title: 'i18n: –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è'
description: '–ú–µ–Ω—è–µ–º —è–∑—ã–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫. –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è SEO'
tags: ['nextjs', 'typescript', 'ssr', 'seo', 'fsd']
createdAt: 2024-07-20T03:39:00+03:00
---

---

## –ß—Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –≤ –∏—Ç–æ–≥–µ?

Next.js –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤. –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —è–∑—ã–∫–∞–º –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–µ–≤–æ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é) –∏ –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é –º–∞—Ä—à—Ä—É—Ç–æ–≤.

–£ –Ω–∞—Å –±—É–¥–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ i18n, —Ç–∞–∫ –∫–∞–∫ –º—ã –ø–∏—à–µ–º –≤—Å—ë –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫. –î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ –Ω–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—É–¥–µ—Ç `middleware.ts`.

–ù–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —è–∑—ã–∫ –≤ `getDictionary(lang)`, –∫–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Next.js](https://nextjs.org/docs/app/building-your-application/routing/internationalization#localization):

```diff hideHeader
- getDictionary(lang)
+ getDictionary()
```

–°–æ–∑–¥–∞–¥–∏–º –∞–Ω–∞–ª–æ–≥ `usePathname()` –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ - `getPathname()`.

–ú—ã —Å–º–æ–∂–µ–º –ø–æ–ª—É—á–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –Ω–µ –ø—Ä–æ–∫–∏–¥—ã–≤–∞—è –∏—Ö –≤ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:

```diff hideHeader
-  export const Navbar = ({ dict }: { dict: Dictionary['ui'] }) => {...}

+  export const Navbar = async () => {
+    const dictionary = await getDictionary();
```

–ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ –ª—é–±–æ–º —Å–µ—Ä–≤–µ—Ä–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `const dict = await getDictionary();`, –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ–º –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞–∫ props `{ dict }: { dict: Dictionary['ui'] }` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º `useDictionary()`

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```tsx hideHeader
export const Component = async () => {
  const dictionary = await getDictionary();
  const lang = await getLang();

  return (
    <>
      <h1>{dictionary.ui['title']}</h1>
      <p>–í—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫: {lang}</p>
    </>
  );
};
```

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è i18n

–°–æ–∑–¥–∞–¥–∏–º –∫–æ–Ω—Ñ–∏–≥ i18n `shared/config/i18n/i18n.config.ts`:

```typescript filename="i18n.config.ts" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/src/shared/config/i18n/i18n.config.ts"
export const i18n = {
  defaultLocale: 'ru',
  locales: ['en', 'ru'],
} as const;

export type Locale = (typeof i18n)['locales'][number];
```

–°–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª—ã —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ `ru.json` –∏ `en.json` –≤ `shared/config/i18n/dictionaries`.

–ü—Ä–∏–º–µ—Ä:

```json filename="ru.json"
{
  "home-page": {
    "note": "–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",
    "title": "üëã –ü—Ä–∏–≤–µ—Ç, —è Mark Melior",
    "description": "–ò—â—É –∫–æ–º–ø–∞–Ω–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞—Ç—å —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –¥–æ —Å–∏–ª—å–Ω–æ–≥–æ Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (:"
  }
}
```

#### Middleware.ts

–í–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–¥–µ—Å—å!

–í `middleware.ts` —Ä–µ–∞–ª–∏–∑—É–µ–º –ø–µ—Ä–µ–¥–∞—á—É url –≤ headers –¥–ª—è –±—É–¥—É—â–µ–≥–æ `getPathname()` + —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

```typescript filename="middleware.ts" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/middleware.ts"
import { i18n } from '@/shared/config/i18n';
import { NextRequest, NextResponse } from 'next/server';

export function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;

  // –ü–µ—Ä–µ–¥–∞—ë–º –≤ headers url —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  // –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ö—É–∫–∞ getPathname()
  const requestHeaders = new Headers(request.headers);
  requestHeaders.set('x-url', request.url);

  // `/_next/" –∏ "/api/" –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–º, –Ω–æ –Ω–∞–º –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –≤ `public`
  const ignoredPaths = [
    /^\/images\/.*$/,
    /^\/videos\/.*$/,
    /^\/files\/.*$/,
    /^\/favicon\.ico$/,
  ];
  if (ignoredPaths.some((regex) => regex.test(pathname))) {
    return;
  }

  if (
    pathname.startsWith(`/${i18n.defaultLocale}/`) ||
    pathname === `/${i18n.defaultLocale}`
  ) {
    // –ï—Å–ª–∏ –≤—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è /ru/whatever, —Ç–æ–≥–¥–∞ –º—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏–º –µ–≥–æ –Ω–∞ /whatever
    const response = NextResponse.redirect(
      new URL(
        pathname.replace(
          `/${i18n.defaultLocale}`,
          pathname === `/${i18n.defaultLocale}` ? '/' : '',
        ),
        request.url,
      ),
      {
        headers: requestHeaders,
      },
    );
    return response;
  }

  const pathnameIsMissingLocale = i18n.locales.every(
    (locale) =>
      !pathname.startsWith(`/${locale}/`) && pathname !== `/${locale}`,
  );

  if (pathnameIsMissingLocale) {
    // –¢–µ–ø–µ—Ä—å –¥–ª—è /en –∏–ª–∏ /ru –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è —É–∫–∞–∑–∞—Ç—å Next.js, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è /ru/whatever
    const response = NextResponse.rewrite(
      new URL(
        `/${i18n.defaultLocale}${pathname}${request.nextUrl.search}`,
        request.nextUrl.href,
      ),
      {
        request: {
          headers: requestHeaders,
        },
      },
    );
    return response;
  }

  const response = NextResponse.next({
    request: {
      headers: requestHeaders,
    },
  });
  return response;
}

export const config = {
  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],
};
```

#### getPathname()

–°–æ–∑–¥–∞—ë–º `getPathname()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞. –ù–µ–∫–∏–π –∞–Ω–∞–ª–æ–≥ —Ö—É–∫–∞ `usePathname()`.

`shared/lib/get-pathname/get-pathname.ts`:

```typescript filename="get-pathname.ts" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/src/shared/lib/get-pathname/get-pathname.ts"
'use server';

import { i18n, Locale } from '@/shared/config/i18n';
import { headers } from 'next/headers';

interface GetPathnameProps {
  withoutLang?: boolean;
}

export const getPathname = async ({ withoutLang }: GetPathnameProps = {}) => {
  const headersList = headers();
  const fullUrl = headersList.get('x-url') || '';

  const url = new URL(fullUrl);
  const pathname = url.pathname;

  if (withoutLang) {
    const segment = pathname.split('/')[1] as Locale;

    if (i18n.locales.includes(segment)) {
      return `/${pathname.split('/').slice(2).join('/')}`;
    }
  }

  return pathname;
};
```

#### getLang()

`const lang = await getLang()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ `en | ru` –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

`shared/config/i18n/get-lang.ts`:

```typescript filename="get-lang.ts" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/src/shared/config/i18n/get-lang.ts"
'use server';

import { getPathname } from '@/shared/lib';
import { Locale, i18n } from './i18n.config';

export const getLang = async (): Promise<Locale> => {
  const pathname = await getPathname();

  const segment = pathname.split('/')[1] as Locale;

  // –ï—Å–ª–∏ —Å–µ–≥–º–µ–Ω—Ç URL –≤–∞–ª–∏–¥–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ
  if (i18n.locales.includes(segment)) return segment;

  // –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  return i18n.defaultLocale;
};
```

#### useLang()

`const lang = useLang()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ `en | ru` –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

`shared/config/i18n/use-lang.ts`:

```typescript filename="use-lang.ts" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/src/shared/config/i18n/use-lang.ts"
'use client';

import { usePathname } from 'next/navigation';
import { Locale, i18n } from './i18n.config';

export const useLang = (): Locale => {
  const pathname = usePathname();

  const segment = pathname.split('/')[1] as Locale;

  if (i18n.locales.includes(segment)) return segment;

  return i18n.defaultLocale;
};
```

#### getDictionaries()

`const dict = await getDictionaries()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ _"–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ"_ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

`shared/config/i18n/dictionaries.ts`:

```typescript filename="dictionaries.ts" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/src/shared/config/i18n/dictionaries.ts"
'use server';

import { getLang } from './get-lang';
import { Locale } from './i18n.config';

const dictionaries = {
  en: () => import('./dictionaries/en.json').then((module) => module.default),
  ru: () => import('./dictionaries/ru.json').then((module) => module.default),
};

export const getDictionary = async (locale?: Locale) => {
  const lang = await getLang();

  return dictionaries[locale || lang]?.() ?? dictionaries.ru();
};

export type Dictionary = Awaited<ReturnType<typeof getDictionary>>;
```

#### useDictionaries()

`const dict = useDictionaries()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ _"–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ"_ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

`shared/config/i18n/use-dictionary.ts`:

```typescript filename="use-dictionary.ts" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/src/shared/config/i18n/use-dictionary.ts"
'use client';

import { useEffect, useState } from 'react';
import { Dictionary } from './dictionaries';
import { Locale } from './i18n.config';
import { useLang } from './use-lang';

export const useDictionary = (locale?: Locale): Dictionary | undefined => {
  const dictionaries = {
    en: () => import('./dictionaries/en.json').then((module) => module.default),
    ru: () => import('./dictionaries/ru.json').then((module) => module.default),
  };

  const [dict, setDict] = useState<Dictionary>();

  const lang = useLang();

  useEffect(() => {
    dictionaries[locale || lang]?.().then(setDict);
  }, [lang, locale]);

  return dict as Dictionary;
};
```

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Link

–ù–∞ —ç—Ç–æ–º –ø–æ—á—Ç–∏ –≤—Å—ë –≥–æ—Ç–æ–≤–æ, –Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å—Å—ã–ª–∫–∏ —É –Ω–∞—Å —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫.

–ß—Ç–æ–±—ã —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, —Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `<Link />` –≤ `shared/config/i18n/link.tsx`:

```tsx filename="link.tsx" exampleLink="https://github.com/MarkMelior/melior-web/blob/Release-0.1.0/src/shared/config/i18n/link.tsx"
'use client';

import NextLink, { LinkProps as NextLinkProps } from 'next/link';
import { FC } from 'react';
import { UrlObject } from 'url';
import { i18n } from './i18n.config';
import { useLang } from './use-lang';

interface LinkProps extends NextLinkProps {
  children: React.ReactNode;
}

const isExternalLink = (href: string | UrlObject): boolean => {
  return (
    typeof href === 'string' &&
    (href.startsWith('http://') || href.startsWith('https://'))
  );
};

const getLocalizedHref = (
  href: string | UrlObject,
  lang: string,
  defaultLocale: string,
): string | UrlObject => {
  if (isExternalLink(href) || typeof href !== 'string') {
    return href;
  }
  return lang === defaultLocale ? href : `/${lang}${href}`;
};

export const Link: FC<
  Omit<React.AnchorHTMLAttributes<HTMLAnchorElement>, keyof LinkProps> &
    LinkProps & {
      children?: React.ReactNode;
    } & React.RefAttributes<HTMLAnchorElement>
> = ({ children, href, ...props }) => {
  const lang = useLang();

  const localizedHref = getLocalizedHref(href, lang, i18n.defaultLocale);

  return (
    <NextLink {...props} href={localizedHref}>
      {children}
    </NextLink>
  );
};
```

> –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `Link` –¥–æ–ª–∂–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–∑ `@/shared/config/i18n`! –ò–Ω–∞—á–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–∞–º –Ω–∞ —Å–∞–π—Ç–µ, –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –±—É–¥–µ—Ç —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è.

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ö–∞–∫ –≤—ã –≤–∏–¥–∏—Ç–µ, —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–∂–Ω–æ –±—É–∫–≤–∞–ª—å–Ω–æ –æ–¥–Ω–∏–º `middleware.ts`. –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã —á–µ—Ä–µ–∑ `const dict = await getDictionaries()` –∏ –≤—Å—ë!

–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ö—É–∫–∏ –Ω—É–∂–Ω—ã –±–æ–ª—å—à–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞, —á–µ–º –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ i18n.

–ï—â—ë –≤–º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —è–∑—ã–∫–∞ –≤ —Ä–æ—É—Ç–µ –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞ `Cookie` –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–æ–Ω–µ—á–Ω–æ. –ù–æ —ç—Ç–æ –±—É–¥–µ—Ç –ø–ª–æ—Ö–æ –¥–ª—è SEO

–°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ! –ù–∞–¥–µ—é—Å—å, –ø–æ–º–æ–≥ —Ç–µ–±–µ (:
